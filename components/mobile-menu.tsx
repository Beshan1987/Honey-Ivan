"use client"

import { useState, useEffect } from "react"
import Link from "next/link"
import { usePathname } from "next/navigation"
import { Menu, X } from "lucide-react"
import styles from "./mobile-menu.module.css"

export function MobileMenu() {
  const [isOpen, setIsOpen] = useState(false)
  const pathname = usePathname()

  const isActive = (path: string) => {
    return pathname === path
  }

  const toggleMenu = () => {
    setIsOpen(!isOpen)
  }

  const closeMenu = () => {
    setIsOpen(false)
  }

  useEffect(() => {
    if (isOpen) {
      document.body.classList.add("menu-open")
    } else {
      document.body.classList.remove("menu-open")
    }

    return () => {
      document.body.classList.remove("menu-open")
    }
  }, [isOpen])

  useEffect(() => {
    closeMenu()
  }, [pathname])

  return (
    <>
      <button className={styles.menuButton} onClick={toggleMenu} aria-label="Открыть меню">
        {isOpen ? <X size={24} /> : <Menu size={24} />}
      </button>

      {isOpen && <div className={styles.overlay} onClick={closeMenu}></div>}

      <div className={`${styles.mobileMenu} ${isOpen ? styles.mobileMenuOpen : ""}`}>
        <div className={styles.menuHeader}>
          <div className={styles.logo}>
            <div className={styles.logoIcon}>
              <svg
                width="193"
                height="120"
                viewBox="0 0 193 120"
                // preserveAspectRatio="xMidYMid meet"
                style={{
                  width: '100%',
                  height: '100%'
                }}><path fill="#000" d="M2.688 98.144q0-.672.048-1.152.048-.528.192-.912 1.296-.096 2.016-.432.72-.384 1.008-1.248.288-.912.288-2.496V71.648q0-1.68-.288-2.592t-1.008-1.248-2.016-.336a3.5 3.5 0 0 1-.192-.912 13 13 0 0 1-.048-1.152q.672.048 1.488.096.816 0 2.112.048h22.944000000000003a59 59 0 0 1 2.112-.048q.864-.048 1.584-.096 0 .624-.048 1.152a3.5 3.5 0 0 1-.192.912q-1.248 0-2.016.336-.72.336-1.008 1.248t-.288 2.592v20.256q0 1.584.288 2.496.288.864 1.008 1.248.768.336 2.016.432.144.384.192.912.048.48.048 1.152A85 85 0 0 0 30 98h-5.856q-1.584.048-2.832.144 0-.672.048-1.152.048-.528.192-.912 1.296-.096 2.016-.432.72-.384 1.008-1.248.288-.912.288-2.496V71.792q0-1.296-.24-2.256-.24-1.008-.96-1.44-.624-.384-1.92-.432-1.248-.096-3.936-.096t-3.984.096q-1.248.048-1.872.432-.72.432-.96 1.44-.24.96-.24 2.256v20.112q0 1.584.288 2.496.288.864 1.008 1.248.768.336 2.016.432.144.384.192.912.048.48.048 1.152A85 85 0 0 0 11.376 98H5.52q-1.584.048-2.832.144m49.4 0q0-.672.047-1.152.048-.528.192-.912 1.536-.096 2.448-.48.912-.432 1.344-1.488.432-1.104.432-3.168V71.648q0-1.632-.288-2.496t-1.008-1.248q-.672-.384-1.92-.432a3.5 3.5 0 0 1-.192-.912 13 13 0 0 1-.048-1.152l1.776.096q.96 0 1.92.048h4.032q.96-.048 1.872-.048l1.872-.096q0 .624-.048 1.152a3.5 3.5 0 0 1-.192.912q-1.248.048-1.968.432-.672.384-.96 1.248t-.288 2.496v20.256q0 1.584.288 2.496.288.864.96 1.248.72.336 1.968.432.144.384.192.912.048.48.048 1.152-.912-.096-2.832-.144H55.88a48 48 0 0 1-2.064.048q-.96.048-1.728.096M49.207 84.8q-3.504 0-5.473-.912-1.968-.96-2.928-2.688-.912-1.728-1.2-4.128a80 80 0 0 1-.432-5.424q-.048-1.488-.24-2.352T38.071 68q-.624-.432-2.112-.528a3.5 3.5 0 0 1-.192-.912 13 13 0 0 1-.048-1.152q.864.048 1.824.096.96 0 1.92.048h3.984q.96-.048 1.872-.048l1.872-.096q0 .624-.048 1.152a3.5 3.5 0 0 1-.192.912q-1.344.096-2.064.48-.672.384-.912 1.392-.24.96-.24 2.88 0 3.744.624 5.952.672 2.208 2.208 3.168 1.536.912 4.176.912 1.008 0 2.736-.096a49 49 0 0 0 3.36-.384v2.064a30 30 0 0 1-3.6.72q-2.016.24-4.032.24M84.45 65.264l11.424 26.208q.816 1.776 1.344 2.736t1.056 1.344q.576.384 1.296.528.192.624.24 1.056t.048 1.008q-.48-.048-1.488-.096-1.008 0-2.112-.048h-3.216q-.768.048-1.584.048a26 26 0 0 1-1.488.048q-.624.048-1.008.048 0-.576.048-1.104.096-.528.288-.96 1.968-.24 2.304-.864.384-.672-.576-2.88l-6.672-15.6q-.624-1.488-1.104-2.64a98 98 0 0 1-1.152-2.928h.24a69 69 0 0 1-1.056 3.12 100 100 0 0 1-.864 2.4l-5.472 14.256q-1.056 2.832-.672 3.936.432 1.056 2.4 1.2.192.432.24.96.096.528.096 1.104a47 47 0 0 0-1.296-.096q-.768 0-1.632-.048H72.45q-1.2 0-2.256.048t-1.728.096q0-.48.048-1.008.096-.576.288-1.008.864-.192 1.44-.672t1.104-1.536q.576-1.104 1.296-2.976l9.936-25.488q.48-.096.864-.144a9 9 0 0 1 1.008-.048m4.368 20.016.432 2.16q-3.216 0-6.912.048-3.648.048-6.624.144l.768-2.352zm16.997 13.152q-1.248 0-2.16-.384t-1.344-.72q-.192-.912-.192-2.16.048-1.248.24-2.304.912.144 1.728.24.816.048 1.296.048 1.248 0 2.304-.72 1.056-.768 1.872-3.072 1.056-2.832 1.632-7.536t.816-10.08q.096-1.584-.048-2.448t-.912-1.248q-.72-.432-2.544-.576a3.5 3.5 0 0 1-.192-.912 13 13 0 0 1-.048-1.152q1.536.048 4.368.096t7.632.048h5.136q1.968-.048 3.216-.048 1.248-.048 2.208-.096 0 .624-.048 1.152a3.5 3.5 0 0 1-.192.912q-1.248.048-2.016.432-.72.384-1.008 1.248t-.288 2.496v20.256q0 1.584.288 2.496.288.864 1.008 1.248.768.336 2.016.432.144.384.192.912.048.48.048 1.152a85 85 0 0 0-2.928-.144h-5.856q-1.584.048-2.832.144 0-.672.048-1.152.048-.528.192-.912 1.296-.096 2.016-.432.72-.384 1.008-1.248.288-.912.288-2.496V71.648q0-1.776-.24-2.592t-.912-1.152q-.768-.384-1.824-.48t-1.44-.096q-.624 0-1.44.144a4 4 0 0 0-1.44.432 1.78 1.78 0 0 0-.768.768q-.192.432-.288 1.152a94 94 0 0 1-.144 1.824q-.48 7.776-1.152 12.96-.624 5.136-1.584 8.208-.912 3.024-2.352 4.32-1.392 1.296-3.36 1.296m44.437-.288q0-.528.048-1.056.048-.576.192-1.008 1.248-.096 1.92-.432.672-.384.96-1.248.288-.912.288-2.496v-24.48l.24.528a16 16 0 0 0-2.112-.336 21 21 0 0 0-1.968-.096q-3.984 0-5.568 1.776t-1.584 4.464q0 2.736 1.2 4.368t3.216 2.4q2.016.72 4.464.72.528 0 1.008-.048.528-.048 1.104-.144v1.68h-4.944q-3.648-.288-6.048-1.392-2.352-1.152-3.552-2.976-1.152-1.872-1.152-4.224 0-2.304 1.152-4.272 1.152-2.016 3.792-3.216t7.056-1.2q1.056 0 2.736.048t3.6.048h1.968a47 47 0 0 1 2.016-.048q.96-.048 1.44-.048 0 .576-.048 1.056t-.192.96q-1.296 0-2.016.384t-1.008 1.296q-.288.864-.288 2.496v20.256q0 1.584.288 2.496.288.864 1.008 1.248.72.336 2.016.432.144.48.192 1.008t.048 1.056A46 46 0 0 0 158.94 98h-6.5760000000000005q-1.056.048-2.112.144m-9.216.288a38 38 0 0 0-2.016-.288 30 30 0 0 0-1.824-.144h-2.4a5 5 0 0 1-.144-.672l-.096-.672v-.576q1.776-.192 2.736-1.056t1.44-2.16.816-2.736q.384-1.44.864-2.832a8.6 8.6 0 0 1 1.392-2.544q.96-1.2 2.592-1.872 1.68-.72 4.416-.72h4.848v1.152q-3.072 0-4.944.72-1.824.72-2.832 1.92-.96 1.2-1.44 2.736a34 34 0 0 0-.72 3.12q-.336 2.112-.864 3.792a6.2 6.2 0 0 1-1.824 2.832m26.043-.288q0-.672.048-1.152.048-.528.192-.912 1.296-.096 2.016-.432.72-.384 1.008-1.248.288-.912.288-2.496V71.648q0-1.632-.288-2.496t-1.008-1.248-2.016-.432a3.5 3.5 0 0 1-.192-.912 13 13 0 0 1-.048-1.152q1.872.096 3.6.144h4.8a64 64 0 0 1 2.448-.048q1.2-.048 1.776-.048 3.984 0 6.384 1.296t3.456 3.408 1.056 4.608q0 2.736-1.248 5.28-1.2 2.544-3.6 4.176t-6.048 1.632q-2.016 0-3.36-.528a5.6 5.6 0 0 1-.096-1.008q0-.48.144-.96.624.144 1.248.24.624.048 1.296.048a8.7 8.7 0 0 0 3.312-.624q1.536-.624 2.496-2.208.96-1.632.96-4.656 0-3.84-1.92-6.192-1.872-2.4-6.192-2.4-.528 0-1.248.096-.672.048-1.92.336l.72-.72v23.664q0 2.064.432 3.168.432 1.056 1.392 1.488.96.384 2.448.48.144.384.192.912.048.48.048 1.152a93 93 0 0 0-1.728-.096q-.96 0-2.064-.048h-4.656q-1.296.048-2.4.048-1.104.048-1.728.096M81.45 38.32l.1.36c.41-.07.798-.136 1.205-.209 1.597-.28 3.18-.574 4.764-.843 5.538-1.037 11.203-.416 16.742.796.405.086.788.168 1.192.258l.094-.364c-.4-.116-.777-.225-1.177-.336-5.45-1.57-11.329-2.41-17.019-1.34a29 29 0 0 0-4.748 1.249 35 35 0 0 0-1.153.428"></path><path fill="#FAC157" d="M93.5 11c7.766 6.998 12.5 16.297 12.5 26.501s-4.734 19.502-12.5 26.5C85.734 57.003 81 47.705 81 37.501S85.734 17.998 93.5 11"></path><path fill="#FAC157" d="M93.521 16.78c-4.153-.045-7.48-3.822-7.432-8.437q.006-.41.045-.808c1.966-1.548 4.61-2.485 7.512-2.454s5.526 1.024 7.458 2.614q.03.4.027.809c-.05 4.614-3.457 8.32-7.61 8.275"></path><path fill="#000" d="M76 1c1.643.618 3.296 1.186 4.917 1.835 2.633 1.045 5.301 2.462 6.672 4.954 1.383 2.453 1.604 5.383 1.575 8.21l.013-.091c-2.822 9.295-6.193 20.168-15.965 23.546-1.706.674-3.496 1.172-5.315 1.563l.112-.011c-3.36-.08-6.904-.335-9.632-2.18-2.744-1.86-3.995-5.223-5.018-8.434l.011.17c.622-7.257 7.476-11.46 13.77-14.068 1.603-.697 3.23-1.354 4.86-1.994a130 130 0 0 0-4.933 1.819c-6.334 2.356-13.634 6.544-14.437 14.119l.01.17c.98 3.255 2.185 6.832 5.22 8.963 3.018 2.075 6.712 2.319 10.131 2.423l.112-.01c1.86-.392 3.704-.9 5.476-1.6 10.297-3.6 13.64-14.99 16.244-24.292l.013-.09c-.034-2.878-.325-5.9-1.853-8.446-1.527-2.59-4.33-3.942-6.998-4.898C79.335 2.062 77.665 1.556 76 1M110.835.564c-1.627.659-3.266 1.266-4.871 1.955-2.607 1.11-5.239 2.592-6.548 5.116-1.322 2.486-1.472 5.421-1.373 8.246l-.015-.09c3.049 9.223 6.685 20.01 16.537 23.147 1.722.632 3.524 1.086 5.352 1.432l-.112-.008c3.356-.162 6.893-.504 9.575-2.416 2.697-1.926 3.866-5.318 4.809-8.555l-.006.171c-.8-7.24-7.755-11.272-14.111-13.725a144 144 0 0 0-4.907-1.875c1.667.537 3.331 1.094 4.975 1.697 6.39 2.2 13.791 6.208 14.78 13.76l-.007.172c-.898 3.277-2.016 6.883-4.997 9.088-2.967 2.148-6.654 2.482-10.069 2.67l-.112-.007c-1.869-.347-3.725-.809-5.515-1.465-10.382-3.346-14.003-14.651-16.834-23.886l-.015-.09c-.036-2.878.18-5.907 1.645-8.489 1.463-2.626 4.232-4.046 6.876-5.069 1.634-.636 3.292-1.183 4.943-1.779"></path><path fill="#000" d="M83.5 23a59 59 0 0 0-1.817.876c-5.377 2.465-10.67 7.315-10.971 13.729a34 34 0 0 0-.204 2.366l.035.216c1.886 4.633 5.114 10.635 10.938 10.341.675.024 1.348.008 2.019-.028a26 26 0 0 1-2.004-.161c-5.655-.262-8.14-5.868-10.04-10.526l.036.216c.051-.774.118-1.54.212-2.3.317-6.105 4.896-10.659 10.073-13.687q.842-.525 1.723-1.042M103.5 23q.927.428 1.816.876c5.378 2.465 10.67 7.315 10.972 13.729.098.787.162 1.575.204 2.366l-.035.215c-1.886 4.634-5.114 10.636-10.938 10.342-.675.024-1.348.007-2.019-.028a26 26 0 0 0 2.004-.161c5.655-.263 8.14-5.869 10.039-10.526l-.035.216a40 40 0 0 0-.212-2.3c-.317-6.105-4.896-10.659-10.073-13.687A75 75 0 0 0 103.5 23M83.93 24.326l.14.348c.315-.105.616-.201.931-.301 2.782-.885 5.62-1.55 8.475-1.477 2.857.052 5.698.736 8.518 1.514.319.09.622.174.943.267l.126-.354c-.308-.132-.6-.255-.91-.38-2.727-1.102-5.627-1.99-8.658-2.047-3.034-.077-5.99.808-8.67 2.015-.304.136-.593.271-.895.415"></path><path fill="#000" d="m81.947 32.32.106.36c.388-.093.757-.179 1.144-.267 3.419-.782 6.873-1.36 10.326-1.241 3.455.099 6.88.843 10.282 1.71.386.1.751.194 1.138.297l.114-.358a64 64 0 0 0-1.106-.41c-3.318-1.195-6.8-2.134-10.397-2.239-3.597-.123-7.145.653-10.49 1.765-.38.125-.74.25-1.117.383M105.958 40.183l.084-.366a94 94 0 0 0-1.228-.334c-3.677-.97-7.458-1.73-11.316-1.777-3.858-.064-7.682.653-11.328 1.739a61 61 0 0 0-1.218.374l.096.362c.42-.09.82-.172 1.24-.257 3.712-.753 7.45-1.28 11.197-1.218 3.747.045 7.485.62 11.224 1.26.424.073.825.142 1.249.217M82.438 46.823l.124.354a86 86 0 0 1 1.083-.303c3.242-.888 6.531-1.543 9.838-1.483 3.307.04 6.595.731 9.868 1.52.371.09.722.175 1.094.268l.11-.358a64 64 0 0 0-1.064-.384c-3.191-1.115-6.536-2.003-9.995-2.046-3.459-.063-6.85.798-10.004 2.013-.36.138-.698.273-1.054.419M85 53c.29-.072.564-.137.854-.206 2.555-.607 5.093-1.092 7.634-1.055 2.541.022 5.083.532 7.653 1.077.291.062.567.12.859.184a35 35 0 0 0-.801-.365c-2.402-1.057-4.991-1.87-7.7-1.896-2.71-.039-5.332.759-7.707 1.875-.272.127-.525.252-.792.386M89 59c.16-.013.31-.024.468-.038 1.396-.117 2.727-.266 4.035-.268 1.308-.01 2.635.133 4.03.263.158.016.308.028.467.043-.14-.078-.271-.152-.413-.225-1.242-.648-2.635-1.09-4.088-1.08-1.452.002-2.836.449-4.084 1.084-.142.072-.275.144-.415.221M93.426 64.049l-1.561-1.598 3.193.071z"></path></svg>
            </div>
            {/* <span className={styles.logoText}>ПЧАЛЯР</span> */}
          </div>
          <button className={styles.closeButton} onClick={closeMenu} aria-label="Закрыть меню">
            <X size={24} />
          </button>
        </div>

        <nav className={styles.navigation}>
          <Link
            href="/"
            className={`${styles.navLink} ${isActive("/") ? styles.navLinkActive : ""}`}
            onClick={closeMenu}
          >
            Главная
          </Link>
          <Link
            href="/products"
            className={`${styles.navLink} ${isActive("/products") ? styles.navLinkActive : ""}`}
            onClick={closeMenu}
          >
            Продукция
          </Link>
          <Link
            href="/about"
            className={`${styles.navLink} ${isActive("/about") ? styles.navLinkActive : ""}`}
            onClick={closeMenu}
          >
            О нас
          </Link>
          <Link
            href="/contact"
            className={`${styles.navLink} ${isActive("/contact") ? styles.navLinkActive : ""}`}
            onClick={closeMenu}
          >
            Контакты
          </Link>
        </nav>

        <div className={styles.menuFooter}>
          <Link href="/products" className={styles.shopButton} onClick={closeMenu}>
            Купить сейчас
          </Link>
        </div>
      </div>
    </>
  )
}
